###
 0000000   00000000   000  0000000  
000        000   000  000  000   000
000  0000  0000000    000  000   000
000   000  000   000  000  000   000
 0000000   000   000  000  0000000  
###

{ splice, alpha } = require './util'

function Grid

    @: (@size=0) -> @clear()

    #  0000000  000      00000000   0000000   00000000   
    # 000       000      000       000   000  000   000  
    # 000       000      0000000   000000000  0000000    
    # 000       000      000       000   000  000   000  
    #  0000000  0000000  00000000  000   000  000   000  
    
    clear: (size) ->
        
        @size = size if size?
        @grid = ''
        for y in 0...@size
            @grid += rpad @size, ''
            @grid += '\n' if y < @size-1
        @
    
    # 000  0000000    000   000  
    # 000  000   000   000 000   
    # 000  000   000    00000    
    # 000  000   000   000 000   
    # 000  0000000    000   000  
    
    idx: (x,y) ->
        
        if not y?
            if 
                x is arr
                    y = x[1]
                    x = x[0] 
                x is str
                    y = @size - int x[1..]
                    x = alpha.indexOf x[0].toUpperCase()
        if not y?
            if x < @size*@size
                x
        else
            if 0 <= x < @size and 0 <= y < @size
                x+(@size+1)*y
                
    #  0000000   000000000  
    # 000   000     000     
    # 000000000     000     
    # 000   000     000     
    # 000   000     000     
    
    at: (x,y) -> 
        
        i = @idx x,y
        if i?
            @grid[i]
        
    #  0000000  00000000  000000000  
    # 000       000          000     
    # 0000000   0000000      000     
    #      000  000          000     
    # 0000000   00000000     000     
    
    set: (x,y,c) ->
        
        if not c? then [c,y] = [y, undefined]
        @grid = splice @grid, @idx(x,y), 1, c
        
    #  0000000  000000000  00000000   000  000   000   0000000   
    # 000          000     000   000  000  0000  000  000        
    # 0000000      000     0000000    000  000 0 000  000  0000  
    #      000     000     000   000  000  000  0000  000   000  
    # 0000000      000     000   000  000  000   000   0000000   
    
    toString: -> @grid
    toJSON: -> @grid

module.exports = Grid
